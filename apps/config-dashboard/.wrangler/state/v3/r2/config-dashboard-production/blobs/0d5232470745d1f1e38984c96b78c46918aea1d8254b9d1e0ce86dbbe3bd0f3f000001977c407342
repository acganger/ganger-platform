(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{708:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(8154)}])},8154:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var a=t(1549),r=t(4335),i=t(4194),l=t(4570);function n(){let{user:e}=(0,r.useAuth)(),[s,t]=(0,i.useState)([]),[n,d]=(0,i.useState)(!0),[o,c]=(0,i.useState)(null),[x,m]=(0,i.useState)(""),[p,u]=(0,i.useState)(1),[h,g]=(0,i.useState)(1);(0,i.useEffect)(()=>{b()},[p,x]);let b=async()=>{try{var e,s,a,r;d(!0);let i=new URLSearchParams({page:p.toString(),limit:"10",...x&&{search:x}}),n=await fetch("/api/applications?".concat(i)),o=await n.json();o.success&&o.data?(t(o.data),g(Math.ceil(((null===(e=o.meta)||void 0===e?void 0:e.total)||0)/((null===(s=o.meta)||void 0===s?void 0:s.limit)||10))),c(null)):(c((null===(a=o.error)||void 0===a?void 0:a.message)||"Failed to fetch applications"),l.ZP.error((null===(r=o.error)||void 0===r?void 0:r.message)||"Failed to fetch applications"))}catch(e){c("Network error occurred"),l.ZP.error("Network error occurred")}finally{d(!1)}};return n?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"bg-gray-200 h-16 rounded"},e))})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Platform Applications"}),(0,a.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Add Application"})]}),(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),u(1),b()},className:"mb-6",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value),placeholder:"Search applications...",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("button",{type:"submit",className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors",children:"Search"})]})}),o&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:o}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Application"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Approval Required"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Version"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Updated"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.display_name}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.app_name}),e.description&&(0,a.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:e.description})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.requires_approval_for_changes?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.requires_approval_for_changes?"Required":"Not Required"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.app_version||"N/A"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.updated_at).toLocaleDateString()}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-900 mr-3",children:"View"}),(0,a.jsx)("button",{className:"text-green-600 hover:text-green-900 mr-3",children:"Configure"}),(0,a.jsx)("button",{className:"text-gray-600 hover:text-gray-900",children:"Permissions"})]})]},e.id))})]})}),h>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Page ",p," of ",h]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>u(Math.max(1,p-1)),disabled:1===p,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>u(Math.min(h,p+1)),disabled:p===h,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]}),0===s.length&&!n&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("div",{className:"text-gray-500",children:"No applications found"})})]})}function d(){let{user:e}=(0,r.useAuth)(),[s,t]=(0,i.useState)([]),[n,d]=(0,i.useState)(!0),[o,c]=(0,i.useState)(null),[x,m]=(0,i.useState)({search:"",app_id:"",environment:"production",approval_status:"",is_sensitive:""}),[p,u]=(0,i.useState)(1),[h,g]=(0,i.useState)(1);(0,i.useEffect)(()=>{b()},[p,x]);let b=async()=>{try{var e,s,a,r;d(!0);let i=new URLSearchParams({page:p.toString(),limit:"15"});Object.entries(x).forEach(e=>{let[s,t]=e;t&&i.append(s,t)});let n=await fetch("/api/configurations?".concat(i)),o=await n.json();o.success&&o.data?(t(o.data),g(Math.ceil(((null===(e=o.meta)||void 0===e?void 0:e.total)||0)/((null===(s=o.meta)||void 0===s?void 0:s.limit)||15))),c(null)):(c((null===(a=o.error)||void 0===a?void 0:a.message)||"Failed to fetch configurations"),l.ZP.error((null===(r=o.error)||void 0===r?void 0:r.message)||"Failed to fetch configurations"))}catch(e){c("Network error occurred"),l.ZP.error("Network error occurred")}finally{d(!1)}},y=(e,s)=>{m(t=>({...t,[e]:s})),u(1)},v=(e,s,t)=>t&&"string"==typeof e&&e.includes("SENSITIVE")?"••••••••":"json"===s&&"object"==typeof e?JSON.stringify(e,null,2):String(e);return n?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[1,2,3,4].map(e=>(0,a.jsx)("div",{className:"bg-gray-200 h-20 rounded"},e))})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Configuration Settings"}),(0,a.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Add Configuration"})]}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,a.jsx)("input",{type:"text",value:x.search,onChange:e=>y("search",e.target.value),placeholder:"Search configurations...",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Environment"}),(0,a.jsxs)("select",{value:x.environment,onChange:e=>y("environment",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All"}),(0,a.jsx)("option",{value:"development",children:"Development"}),(0,a.jsx)("option",{value:"staging",children:"Staging"}),(0,a.jsx)("option",{value:"production",children:"Production"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Approval Status"}),(0,a.jsxs)("select",{value:x.approval_status,onChange:e=>y("approval_status",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All"}),(0,a.jsx)("option",{value:"approved",children:"Approved"}),(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"rejected",children:"Rejected"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sensitive"}),(0,a.jsxs)("select",{value:x.is_sensitive,onChange:e=>y("is_sensitive",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All"}),(0,a.jsx)("option",{value:"true",children:"Sensitive"}),(0,a.jsx)("option",{value:"false",children:"Not Sensitive"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:()=>{m({search:"",app_id:"",environment:"production",approval_status:"",is_sensitive:""}),u(1)},className:"w-full bg-gray-600 text-white px-3 py-2 rounded-md hover:bg-gray-700 transition-colors text-sm",children:"Clear Filters"})})]})}),o&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:o}),(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:e.config_key}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.platform_applications.display_name}),e.config_section&&(0,a.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:e.config_section})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat("approved"===e.approval_status?"bg-green-100 text-green-800":"pending"===e.approval_status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.approval_status}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:e.environment}),e.is_sensitive&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800",children:"Sensitive"}),e.requires_restart&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800",children:"Restart Required"})]})]}),(0,a.jsx)("div",{className:"bg-gray-50 rounded p-3 mb-3",children:(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,a.jsxs)("strong",{children:["Value (",e.value_type,"):"]}),(0,a.jsx)("pre",{className:"mt-1 text-xs font-mono whitespace-pre-wrap",children:v(e.config_value,e.value_type,e.is_sensitive)})]})}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[(0,a.jsxs)("div",{children:["Updated: ",new Date(e.updated_at).toLocaleString()]}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-800",children:"Edit"}),(0,a.jsx)("button",{className:"text-green-600 hover:text-green-800",children:"History"}),(0,a.jsx)("button",{className:"text-red-600 hover:text-red-800",children:"Delete"})]})]})]},e.id))}),h>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Page ",p," of ",h]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>u(Math.max(1,p-1)),disabled:1===p,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>u(Math.min(h,p+1)),disabled:p===h,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]}),0===s.length&&!n&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("div",{className:"text-gray-500",children:"No configurations found"})})]})}function o(){let{user:e}=(0,r.useAuth)(),[s,t]=(0,i.useState)([]),[n,d]=(0,i.useState)(!0),[o,c]=(0,i.useState)(null),[x,m]=(0,i.useState)({app_id:"",permission_type:"",permission_level:"",is_active:"true"}),[p,u]=(0,i.useState)(1),[h,g]=(0,i.useState)(1);(0,i.useEffect)(()=>{b()},[p,x]);let b=async()=>{try{var e,s,a,r;d(!0);let i=new URLSearchParams({page:p.toString(),limit:"20"});Object.entries(x).forEach(e=>{let[s,t]=e;t&&i.append(s,t)});let n=await fetch("/api/permissions?".concat(i)),o=await n.json();o.success&&o.data?(t(o.data),g(Math.ceil(((null===(e=o.meta)||void 0===e?void 0:e.total)||0)/((null===(s=o.meta)||void 0===s?void 0:s.limit)||20))),c(null)):(c((null===(a=o.error)||void 0===a?void 0:a.message)||"Failed to fetch permissions"),l.ZP.error((null===(r=o.error)||void 0===r?void 0:r.message)||"Failed to fetch permissions"))}catch(e){c("Network error occurred"),l.ZP.error("Network error occurred")}finally{d(!1)}},y=(e,s)=>{m(t=>({...t,[e]:s})),u(1)},v=e=>{switch(e){case"admin":return"bg-red-100 text-red-800";case"write":return"bg-yellow-100 text-yellow-800";case"read":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},j=e=>"role"===e?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800";return n?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"bg-gray-200 h-16 rounded"},e))})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Access Permissions"}),(0,a.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Grant Permission"})]}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permission Type"}),(0,a.jsxs)("select",{value:x.permission_type,onChange:e=>y("permission_type",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Types"}),(0,a.jsx)("option",{value:"role",children:"Role-based"}),(0,a.jsx)("option",{value:"user",children:"User-specific"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permission Level"}),(0,a.jsxs)("select",{value:x.permission_level,onChange:e=>y("permission_level",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Levels"}),(0,a.jsx)("option",{value:"read",children:"Read"}),(0,a.jsx)("option",{value:"write",children:"Write"}),(0,a.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsxs)("select",{value:x.is_active,onChange:e=>y("is_active",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All"}),(0,a.jsx)("option",{value:"true",children:"Active"}),(0,a.jsx)("option",{value:"false",children:"Inactive"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:()=>{m({app_id:"",permission_type:"",permission_level:"",is_active:"true"}),u(1)},className:"w-full bg-gray-600 text-white px-3 py-2 rounded-md hover:bg-gray-700 transition-colors text-sm",children:"Clear Filters"})})]})}),o&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:o}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Application"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Permission Level"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scope"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Granted By"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>{var s,t,r;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.platform_applications.display_name}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.platform_applications.app_name})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(j(e.permission_type)),children:e.permission_type}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"role"===e.permission_type?e.role_name:(null===(s=e.users)||void 0===s?void 0:s.email)||"Unknown User"}),"user"===e.permission_type&&(null===(t=e.users)||void 0===t?void 0:t.name)&&(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.users.name})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(v(e.permission_level)),children:e.permission_level})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.config_section?(0,a.jsxs)("span",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:["Section: ",e.config_section]}):e.specific_keys&&e.specific_keys.length>0?(0,a.jsxs)("span",{className:"bg-blue-100 px-2 py-1 rounded text-xs",children:["Keys: ",e.specific_keys.length]}):(0,a.jsx)("span",{className:"text-gray-500",children:"All configurations"})})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full w-fit ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"}),e.expires_at&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Expires: ",new Date(e.expires_at).toLocaleDateString()]})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:(null===(r=e.granted_by_user)||void 0===r?void 0:r.email)||"System"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-900 mr-3",children:"Edit"}),(0,a.jsx)("button",{className:"text-red-600 hover:text-red-900",children:"Revoke"})]})]},e.id)})})]})}),h>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Page ",p," of ",h]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>u(Math.max(1,p-1)),disabled:1===p,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>u(Math.min(h,p+1)),disabled:p===h,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]}),0===s.length&&!n&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("div",{className:"text-gray-500",children:"No permissions found"})})]})}function c(){var e;let{user:s}=(0,r.useAuth)(),[t,n]=(0,i.useState)(null),[d,o]=(0,i.useState)(!0),[c,x]=(0,i.useState)([]),[m,p]=(0,i.useState)(!1),[u,h]=(0,i.useState)({target_user_id:"",reason:"",location:"",max_duration_minutes:60}),[g,b]=(0,i.useState)(!1);(0,i.useEffect)(()=>{y(),v();let e=setInterval(y,3e4);return()=>clearInterval(e)},[]);let y=async()=>{try{let e=await fetch("/api/impersonation/status"),s=await e.json();s.success&&s.data?n(s.data):console.error("Failed to fetch impersonation status:",s.error)}catch(e){console.error("Error fetching impersonation status:",e)}finally{o(!1)}},v=async()=>{try{x([])}catch(e){console.error("Error fetching users:",e)}},j=async e=>{if(e.preventDefault(),!u.target_user_id||!u.reason.trim()){l.ZP.error("Please select a user and provide a reason");return}b(!0);try{let e=await fetch("/api/impersonation/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),t=await e.json();if(t.success)l.ZP.success("Impersonation session started successfully"),p(!1),h({target_user_id:"",reason:"",location:"",max_duration_minutes:60}),y();else{var s;l.ZP.error((null===(s=t.error)||void 0===s?void 0:s.message)||"Failed to start impersonation")}}catch(e){l.ZP.error("Network error occurred")}finally{b(!1)}},f=async e=>{b(!0);try{let t=await fetch("/api/impersonation/end",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:e})}),a=await t.json();if(a.success)l.ZP.success("Impersonation session ended successfully"),y();else{var s;l.ZP.error((null===(s=a.error)||void 0===s?void 0:s.message)||"Failed to end impersonation")}}catch(e){l.ZP.error("Network error occurred")}finally{b(!1)}};return d?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"bg-gray-200 h-6 w-48 rounded mb-4"}),(0,a.jsx)("div",{className:"bg-gray-200 h-20 rounded"})]})}):t?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"User Impersonation"}),t.can_impersonate&&!t.is_impersonating&&(0,a.jsx)("button",{onClick:()=>p(!0),className:"bg-orange-600 text-white px-4 py-2 rounded-md hover:bg-orange-700 transition-colors",children:"Start Impersonation"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 mb-6",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Current Status"})}),(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:t.can_impersonate?"Yes":"No"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Can Impersonate"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold ".concat(t.is_impersonating?"text-orange-600":"text-gray-900"),children:t.is_impersonating?"Active":"None"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Impersonation Session"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold ".concat(t.is_being_impersonated?"text-red-600":"text-gray-900"),children:t.is_being_impersonated?"Yes":"No"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Being Impersonated"})]})]})})]}),t.active_session&&(0,a.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-orange-900 mb-2",children:"Active Impersonation Session"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Target User:"})," ",null===(e=t.active_session.target_user)||void 0===e?void 0:e.email,t.active_session.target_user.name&&(0,a.jsxs)("span",{className:"text-gray-600",children:[" (",t.active_session.target_user.name,")"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Started:"})," ",new Date(t.active_session.started_at).toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Expires:"})," ",new Date(t.active_session.expires_at).toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Time Remaining:"})," ",(e=>{let s=Math.floor(e/60),t=e%60;return s>0?"".concat(s,"h ").concat(t,"m"):"".concat(t,"m")})(t.active_session.time_remaining_minutes)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Reason:"})," ",t.active_session.reason]}),t.active_session.location&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Location:"})," ",t.active_session.location]})]})]}),(0,a.jsx)("button",{onClick:()=>f(),disabled:g,className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",children:g?"Ending...":"End Session"})]})}),t.impersonated_by&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-red-900 mb-2",children:"⚠️ You are being impersonated"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Impersonator:"})," ",t.impersonated_by.impersonator.email,t.impersonated_by.impersonator.name&&(0,a.jsxs)("span",{className:"text-gray-600",children:[" (",t.impersonated_by.impersonator.name,")"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Started:"})," ",new Date(t.impersonated_by.started_at).toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Expires:"})," ",new Date(t.impersonated_by.expires_at).toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Reason:"})," ",t.impersonated_by.reason]}),t.impersonated_by.location&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Location:"})," ",t.impersonated_by.location]})]})]}),m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Start Impersonation Session"})}),(0,a.jsxs)("form",{onSubmit:j,className:"px-6 py-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target User Email"}),(0,a.jsx)("input",{type:"email",value:u.target_user_id,onChange:e=>h(s=>({...s,target_user_id:e.target.value})),placeholder:"user@gangerdermatology.com",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Impersonation"}),(0,a.jsx)("textarea",{value:u.reason,onChange:e=>h(s=>({...s,reason:e.target.value})),placeholder:"Explain why you need to impersonate this user...",rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location (Optional)"}),(0,a.jsx)("input",{type:"text",value:u.location,onChange:e=>h(s=>({...s,location:e.target.value})),placeholder:"e.g., Main Office, Remote",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Session Duration (Minutes)"}),(0,a.jsxs)("select",{value:u.max_duration_minutes,onChange:e=>h(s=>({...s,max_duration_minutes:parseInt(e.target.value)})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:15,children:"15 minutes"}),(0,a.jsx)("option",{value:30,children:"30 minutes"}),(0,a.jsx)("option",{value:60,children:"1 hour"}),(0,a.jsx)("option",{value:120,children:"2 hours"}),(0,a.jsx)("option",{value:240,children:"4 hours"}),(0,a.jsx)("option",{value:480,children:"8 hours"})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",disabled:g,className:"flex-1 bg-orange-600 text-white py-2 px-4 rounded-md hover:bg-orange-700 transition-colors disabled:opacity-50",children:g?"Starting...":"Start Session"}),(0,a.jsx)("button",{type:"button",onClick:()=>p(!1),className:"flex-1 bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition-colors",children:"Cancel"})]})]})]})}),!t.can_impersonate&&(0,a.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"text-gray-600 text-center",children:["You do not have permission to impersonate other users.",(0,a.jsx)("br",{}),"Contact your administrator if you need impersonation access."]})})]}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"text-red-600",children:"Failed to load impersonation status"})})}function x(){let{user:e}=(0,r.useAuth)(),[s,t]=(0,i.useState)([]),[n,d]=(0,i.useState)(!0),[o,c]=(0,i.useState)(null),[x,m]=(0,i.useState)({action:"",app_id:"",user_id:"",search:"",date_from:"",date_to:""}),[p,u]=(0,i.useState)(1),[h,g]=(0,i.useState)(1),[b,y]=(0,i.useState)(null);(0,i.useEffect)(()=>{v()},[p,x]);let v=async()=>{try{var e,s,a,r;d(!0);let i=new URLSearchParams({page:p.toString(),limit:"20"});Object.entries(x).forEach(e=>{let[s,t]=e;t&&i.append(s,t)});let n=await fetch("/api/audit-logs?".concat(i)),o=await n.json();o.success&&o.data?(t(o.data),g(Math.ceil(((null===(e=o.meta)||void 0===e?void 0:e.total)||0)/((null===(s=o.meta)||void 0===s?void 0:s.limit)||20))),c(null)):(c((null===(a=o.error)||void 0===a?void 0:a.message)||"Failed to fetch audit logs"),l.ZP.error((null===(r=o.error)||void 0===r?void 0:r.message)||"Failed to fetch audit logs"))}catch(e){c("Network error occurred"),l.ZP.error("Network error occurred")}finally{d(!1)}},j=(e,s)=>{m(t=>({...t,[e]:s})),u(1)},f=e=>{switch(e){case"CONFIGURATION_CREATED":case"APPLICATION_CREATED":case"PERMISSION_GRANTED":return"bg-green-100 text-green-800";case"CONFIGURATION_UPDATED":case"APPLICATION_UPDATED":case"PERMISSION_MODIFIED":return"bg-blue-100 text-blue-800";case"CONFIGURATION_DELETED":case"APPLICATION_DELETED":case"PERMISSION_REVOKED":return"bg-red-100 text-red-800";case"IMPERSONATION_STARTED":case"IMPERSONATION_ENDED":return"bg-orange-100 text-orange-800";case"LOGIN":case"LOGOUT":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},N=e=>null==e?"null":"object"==typeof e?JSON.stringify(e,null,2):String(e);return n?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[1,2,3,4].map(e=>(0,a.jsx)("div",{className:"bg-gray-200 h-16 rounded"},e))})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Audit Logs"}),(0,a.jsx)("button",{onClick:v,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Refresh"})]}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,a.jsx)("input",{type:"text",value:x.search,onChange:e=>j("search",e.target.value),placeholder:"Search logs...",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action"}),(0,a.jsxs)("select",{value:x.action,onChange:e=>j("action",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Actions"}),(0,a.jsx)("option",{value:"CONFIGURATION_CREATED",children:"Config Created"}),(0,a.jsx)("option",{value:"CONFIGURATION_UPDATED",children:"Config Updated"}),(0,a.jsx)("option",{value:"CONFIGURATION_DELETED",children:"Config Deleted"}),(0,a.jsx)("option",{value:"PERMISSION_GRANTED",children:"Permission Granted"}),(0,a.jsx)("option",{value:"PERMISSION_MODIFIED",children:"Permission Modified"}),(0,a.jsx)("option",{value:"PERMISSION_REVOKED",children:"Permission Revoked"}),(0,a.jsx)("option",{value:"IMPERSONATION_STARTED",children:"Impersonation Started"}),(0,a.jsx)("option",{value:"IMPERSONATION_ENDED",children:"Impersonation Ended"}),(0,a.jsx)("option",{value:"LOGIN",children:"Login"}),(0,a.jsx)("option",{value:"LOGOUT",children:"Logout"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),(0,a.jsx)("input",{type:"date",value:x.date_from,onChange:e=>j("date_from",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),(0,a.jsx)("input",{type:"date",value:x.date_to,onChange:e=>j("date_to",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsx)("div",{className:"md:col-span-2 flex items-end",children:(0,a.jsx)("button",{onClick:()=>{m({action:"",app_id:"",user_id:"",search:"",date_from:"",date_to:""}),u(1)},className:"w-full bg-gray-600 text-white px-3 py-2 rounded-md hover:bg-gray-700 transition-colors text-sm",children:"Clear Filters"})})]})}),o&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:o}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Application"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IP Address"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.created_at).toLocaleString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.users.email}),e.users.name&&(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.users.name})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(f(e.action)),children:e.action})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.platform_applications?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.platform_applications.display_name}),(0,a.jsx)("div",{className:"text-gray-500",children:e.platform_applications.app_name})]}):(0,a.jsx)("span",{className:"text-gray-500",children:"System"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:e.description}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.ip_address||"Unknown"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsx)("button",{onClick:()=>y(e),className:"text-blue-600 hover:text-blue-900",children:"View Details"})})]},e.id))})]})}),h>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Page ",p," of ",h]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>u(Math.max(1,p-1)),disabled:1===p,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>u(Math.min(h,p+1)),disabled:p===h,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]}),0===s.length&&!n&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("div",{className:"text-gray-500",children:"No audit logs found"})}),b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Audit Log Details"}),(0,a.jsx)("button",{onClick:()=>y(null),className:"text-gray-400 hover:text-gray-600",children:"✕"})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Timestamp"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:new Date(b.created_at).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"User"}),(0,a.jsxs)("div",{className:"mt-1 text-sm text-gray-900",children:[b.users.email,b.users.name&&" (".concat(b.users.name,")")]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Action"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(f(b.action)),children:b.action})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Application"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:b.platform_applications?"".concat(b.platform_applications.display_name," (").concat(b.platform_applications.app_name,")"):"System"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"IP Address"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:b.ip_address||"Unknown"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"User Agent"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900 break-all",children:b.user_agent||"Unknown"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:b.description})]}),b.before_value&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Before Value"}),(0,a.jsx)("pre",{className:"mt-1 text-xs bg-gray-100 p-3 rounded border overflow-x-auto",children:N(b.before_value)})]}),b.after_value&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"After Value"}),(0,a.jsx)("pre",{className:"mt-1 text-xs bg-gray-100 p-3 rounded border overflow-x-auto",children:N(b.after_value)})]}),b.metadata&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Additional Metadata"}),(0,a.jsx)("pre",{className:"mt-1 text-xs bg-gray-100 p-3 rounded border overflow-x-auto",children:N(b.metadata)})]})]}),(0,a.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,a.jsx)("button",{onClick:()=>y(null),className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors",children:"Close"})})]})})]})}function m(){var e,s;let{user:t}=(0,r.useAuth)(),[n,d]=(0,i.useState)([]),[o,c]=(0,i.useState)(!0),[x,m]=(0,i.useState)(null),[p,u]=(0,i.useState)({status:"pending",priority:"",app_id:""}),[h,g]=(0,i.useState)(1),[b,y]=(0,i.useState)(1),[v,j]=(0,i.useState)({pending:0,high_priority:0,overdue:0}),[f,N]=(0,i.useState)(null),[w,_]=(0,i.useState)(!1),[k,S]=(0,i.useState)(null),[C,A]=(0,i.useState)({reason:"",feedback:"",apply_immediately:!0});(0,i.useEffect)(()=>{E()},[h,p]);let E=async()=>{try{var e,s,t,a,r;c(!0);let i=new URLSearchParams({page:h.toString(),limit:"15"});Object.entries(p).forEach(e=>{let[s,t]=e;t&&i.append(s,t)});let n=await fetch("/api/approval/pending?".concat(i)),o=await n.json();o.success&&o.data?(d(o.data),y(Math.ceil(((null===(e=o.meta)||void 0===e?void 0:e.total)||0)/((null===(s=o.meta)||void 0===s?void 0:s.limit)||15))),j((null===(t=o.meta)||void 0===t?void 0:t.summary)||{pending:0,high_priority:0,overdue:0}),m(null)):(m((null===(a=o.error)||void 0===a?void 0:a.message)||"Failed to fetch pending changes"),l.ZP.error((null===(r=o.error)||void 0===r?void 0:r.message)||"Failed to fetch pending changes"))}catch(e){m("Network error occurred"),l.ZP.error("Network error occurred")}finally{c(!1)}},P=(e,s)=>{u(t=>({...t,[e]:s})),g(1)},I=async()=>{if(!f)return;let e="approve"===k,s="/api/approval/".concat(f.id,"/").concat(e?"approve":"reject"),t=e?{comments:C.reason,apply_immediately:C.apply_immediately}:{reason:C.reason,feedback:C.feedback};_(!0);try{let r=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),i=await r.json();if(i.success)l.ZP.success("Change ".concat(e?"approved":"rejected"," successfully")),N(null),S(null),A({reason:"",feedback:"",apply_immediately:!0}),E();else{var a;l.ZP.error((null===(a=i.error)||void 0===a?void 0:a.message)||"Failed to ".concat(e?"approve":"reject"," change"))}}catch(e){l.ZP.error("Network error occurred")}finally{_(!1)}},R=e=>{switch(e){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},D=e=>{switch(e){case"CREATE":return"bg-green-100 text-green-800";case"UPDATE":return"bg-blue-100 text-blue-800";case"DELETE":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},O=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string";return null==e?"null":"json"===s&&"object"==typeof e?JSON.stringify(e,null,2):String(e)};return o?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"bg-gray-200 h-24 rounded"},e))})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Approval Workflow"}),(0,a.jsx)("button",{onClick:E,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Refresh"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:v.pending}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Pending Changes"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:v.high_priority}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"High Priority"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:v.overdue}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Overdue (>24h)"})]})]}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsxs)("select",{value:p.status,onChange:e=>P("status",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Statuses"}),(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"approved",children:"Approved"}),(0,a.jsx)("option",{value:"rejected",children:"Rejected"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,a.jsxs)("select",{value:p.priority,onChange:e=>P("priority",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Priorities"}),(0,a.jsx)("option",{value:"critical",children:"Critical"}),(0,a.jsx)("option",{value:"high",children:"High"}),(0,a.jsx)("option",{value:"medium",children:"Medium"}),(0,a.jsx)("option",{value:"low",children:"Low"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:()=>{u({status:"pending",priority:"",app_id:""}),g(1)},className:"w-full bg-gray-600 text-white px-3 py-2 rounded-md hover:bg-gray-700 transition-colors text-sm",children:"Clear Filters"})})]})}),x&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:x}),(0,a.jsx)("div",{className:"space-y-4",children:n.map(e=>{var s,t;return(0,a.jsxs)("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow ".concat(e.urgency_score>=5?"border-red-300 bg-red-50":e.urgency_score>=3?"border-orange-300 bg-orange-50":"border-gray-200 bg-white"),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:e.config_key}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.platform_applications.display_name}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(D(e.change_type)),children:e.change_type}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(R(e.priority)),children:e.priority}),e.hours_old>24&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Overdue"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.reason}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Requested by ",null===(s=e.requested_by_user)||void 0===s?void 0:s.email," • ",e.hours_old,"h ago • ",e.environment]})]}),"pending"===e.status&&(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{N(e),S("approve")},className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors",children:"Approve"}),(0,a.jsx)("button",{onClick:()=>{N(e),S("reject")},className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:"Reject"}),(0,a.jsx)("button",{onClick:()=>N(e),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors",children:"Details"})]}),"pending"!==e.status&&(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat("approved"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status}),e.approved_by_user&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["by ",null===(t=e.approved_by_user)||void 0===t?void 0:t.email]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded p-2 text-sm",children:["CREATE"===e.change_type&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"New Value:"}),(0,a.jsx)("pre",{className:"text-xs mt-1 whitespace-pre-wrap",children:O(e.new_value,e.value_type)})]}),"UPDATE"===e.change_type&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Old Value:"}),(0,a.jsx)("pre",{className:"text-xs mt-1 whitespace-pre-wrap",children:O(e.old_value,e.value_type)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"New Value:"}),(0,a.jsx)("pre",{className:"text-xs mt-1 whitespace-pre-wrap",children:O(e.new_value,e.value_type)})]})]}),"DELETE"===e.change_type&&(0,a.jsx)("div",{className:"text-red-600",children:(0,a.jsx)("strong",{children:"Configuration will be deleted"})})]})]},e.id)})}),b>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Page ",h," of ",b]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>g(Math.max(1,h-1)),disabled:1===h,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>g(Math.min(b,h+1)),disabled:h===b,className:"px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]}),0===n.length&&!o&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("div",{className:"text-gray-500",children:"No changes found"})}),f&&k&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"approve"===k?"Approve Change":"Reject Change"}),(0,a.jsx)("button",{onClick:()=>{N(null),S(null),A({reason:"",feedback:"",apply_immediately:!0})},className:"text-gray-400 hover:text-gray-600",children:"✕"})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Change Details"}),(0,a.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Config Key:"})," ",f.config_key]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Application:"})," ",f.platform_applications.display_name]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Change Type:"})," ",f.change_type]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Priority:"})," ",f.priority]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Reason:"})," ",f.reason]})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"approve"===k?"Comments (Optional)":"Rejection Reason (Required)"}),(0,a.jsx)("textarea",{value:C.reason,onChange:e=>A(s=>({...s,reason:e.target.value})),placeholder:"approve"===k?"Optional comments about this approval...":"Explain why this change is being rejected...",rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:"reject"===k})]}),"reject"===k&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Feedback (Optional)"}),(0,a.jsx)("textarea",{value:C.feedback,onChange:e=>A(s=>({...s,feedback:e.target.value})),placeholder:"Provide suggestions for improvement...",rows:2,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),"approve"===k&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"apply_immediately",checked:C.apply_immediately,onChange:e=>A(s=>({...s,apply_immediately:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"apply_immediately",className:"ml-2 block text-sm text-gray-900",children:"Apply change immediately after approval"})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{onClick:I,disabled:w||"reject"===k&&!C.reason.trim(),className:"flex-1 py-2 px-4 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed ".concat("approve"===k?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700"),children:w?"approve"===k?"Approving...":"Rejecting...":"approve"===k?"Approve Change":"Reject Change"}),(0,a.jsx)("button",{onClick:()=>{N(null),S(null),A({reason:"",feedback:"",apply_immediately:!0})},className:"flex-1 bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition-colors",children:"Cancel"})]})]})]})}),f&&!k&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Change Details"}),(0,a.jsx)("button",{onClick:()=>N(null),className:"text-gray-400 hover:text-gray-600",children:"✕"})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Config Key"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:f.config_key})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Application"}),(0,a.jsxs)("div",{className:"mt-1 text-sm text-gray-900",children:[f.platform_applications.display_name," (",f.platform_applications.app_name,")"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Change Type"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(D(f.change_type)),children:f.change_type})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Priority"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(R(f.priority)),children:f.priority})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Environment"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:f.environment})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat("approved"===f.status?"bg-green-100 text-green-800":"rejected"===f.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:f.status})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for Change"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:f.reason})]}),"DELETE"!==f.change_type&&(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:["UPDATE"===f.change_type&&f.old_value&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Current Value"}),(0,a.jsx)("pre",{className:"mt-1 text-xs bg-gray-100 p-3 rounded border overflow-x-auto",children:O(f.old_value,f.value_type)})]}),f.new_value&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"CREATE"===f.change_type?"Value":"New Value"}),(0,a.jsx)("pre",{className:"mt-1 text-xs bg-gray-100 p-3 rounded border overflow-x-auto",children:O(f.new_value,f.value_type)})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Requested By"}),(0,a.jsxs)("div",{className:"mt-1 text-sm text-gray-900",children:[null===(e=f.requested_by_user)||void 0===e?void 0:e.email,f.requested_by_user.name&&" (".concat(f.requested_by_user.name,")")]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Requested At"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:new Date(f.created_at).toLocaleString()})]})]}),f.approved_by_user&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"approved"===f.status?"Approved By":"Rejected By"}),(0,a.jsxs)("div",{className:"mt-1 text-sm text-gray-900",children:[null===(s=f.approved_by_user)||void 0===s?void 0:s.email,f.approved_by_user.name&&" (".concat(f.approved_by_user.name,")")]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"approved"===f.status?"Approved At":"Rejected At"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:f.approved_at&&new Date(f.approved_at).toLocaleString()})]})]}),f.approval_comments&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"approved"===f.status?"Approval Comments":"Rejection Reason"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:f.approval_comments})]}),f.rejection_feedback&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Rejection Feedback"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-gray-900",children:f.rejection_feedback})]})]}),(0,a.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,a.jsx)("button",{onClick:()=>N(null),className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors",children:"Close"})})]})})]})}function p(e){let{children:s}=e,{user:t,signOut:i}=(0,r.useAuth)();return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Ganger Platform Configuration"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"text-sm text-gray-700",children:null==t?void 0:t.email}),(0,a.jsx)("button",{onClick:()=>i(),className:"text-sm text-gray-500 hover:text-gray-700 transition-colors",children:"Sign Out"})]})]})})}),(0,a.jsx)("main",{className:"py-8 px-4 sm:px-6 lg:px-8",children:s})]})}function u(){let{user:e,loading:s}=(0,r.useAuth)(),[t,l]=(0,i.useState)("applications");return s?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?(0,a.jsx)(p,{children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Configuration Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage application configurations across the Ganger Platform"})]}),(0,a.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,a.jsx)("button",{onClick:()=>l("applications"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("applications"===t?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Applications"}),(0,a.jsx)("button",{onClick:()=>l("configurations"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("configurations"===t?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Configurations"}),(0,a.jsx)("button",{onClick:()=>l("permissions"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("permissions"===t?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Permissions"}),(0,a.jsx)("button",{onClick:()=>l("impersonation"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("impersonation"===t?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Impersonation"}),(0,a.jsx)("button",{onClick:()=>l("approval"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("approval"===t?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Approvals"}),(0,a.jsx)("button",{onClick:()=>l("audit"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("audit"===t?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Audit Logs"})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:["applications"===t&&(0,a.jsx)(n,{}),"configurations"===t&&(0,a.jsx)(d,{}),"permissions"===t&&(0,a.jsx)(o,{}),"impersonation"===t&&(0,a.jsx)(c,{}),"approval"===t&&(0,a.jsx)(m,{}),"audit"===t&&(0,a.jsx)(x,{})]})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-center mb-4",children:"Configuration Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 text-center mb-6",children:"Please sign in to access the configuration dashboard."}),(0,a.jsx)("button",{onClick:()=>window.location.href="/auth/signin",className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Sign In"})]})})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=708)}),_N_E=e.O()}]);