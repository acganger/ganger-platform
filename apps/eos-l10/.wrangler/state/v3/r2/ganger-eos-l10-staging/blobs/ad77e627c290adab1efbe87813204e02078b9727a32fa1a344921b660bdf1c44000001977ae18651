(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[142],{8107:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9284).Z)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},6876:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/rocks",function(){return t(2528)}])},2619:function(e,s,t){"use strict";t.d(s,{AJ:function(){return c},ZP:function(){return i}});var a=t(1549),r=t(4168),l=t(8107),n=t(5985);function i(e){let{page:s="dashboard",showCount:t=!0,showAvatars:i=!0,maxAvatars:c=5}=e,{onlineUsers:d}=(0,r.o)(s);if(0===d.length)return null;let o=d.slice(0,c),m=Math.max(0,d.length-c);return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[i&&(0,a.jsxs)("div",{className:"flex -space-x-2",children:[o.map(e=>(0,a.jsxs)("div",{className:"relative",title:"".concat(e.full_name," - ").concat(e.page),children:[e.avatar_url?(0,a.jsx)("img",{src:e.avatar_url,alt:e.full_name,className:"w-8 h-8 rounded-full border-2 border-white bg-gray-100"}):(0,a.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-white bg-eos-100 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xs font-medium text-eos-700",children:e.full_name.charAt(0).toUpperCase()})}),(0,a.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-400 border-2 border-white rounded-full"})]},e.user_id)),m>0&&(0,a.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-white bg-gray-200 flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-xs font-medium text-gray-600",children:["+",m]})})]}),t&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[(0,a.jsx)(l.Z,{className:"w-2 h-2 fill-green-400 text-green-400"}),(0,a.jsxs)("span",{children:[d.length," online"]})]}),!i&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[(0,a.jsx)(n.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:d.length})]})]})}function c(){let{onlineUsers:e}=(0,r.o)();return(0,a.jsxs)("div",{className:"hidden sm:flex items-center space-x-3 bg-white rounded-lg px-3 py-2 shadow-sm border",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(l.Z,{className:"w-2 h-2 fill-green-400 text-green-400"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 font-medium",children:[e.length," team member",1!==e.length?"s":""," online"]})]}),e.length>0&&(0,a.jsxs)("div",{className:"flex -space-x-2",children:[e.slice(0,3).map(e=>(0,a.jsx)("div",{className:"relative",title:e.full_name,children:e.avatar_url?(0,a.jsx)("img",{src:e.avatar_url,alt:e.full_name,className:"w-6 h-6 rounded-full border-2 border-white"}):(0,a.jsx)("div",{className:"w-6 h-6 rounded-full border-2 border-white bg-eos-100 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xs font-medium text-eos-700",children:e.full_name.charAt(0).toUpperCase()})})},e.user_id)),e.length>3&&(0,a.jsx)("div",{className:"w-6 h-6 rounded-full border-2 border-white bg-gray-200 flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-xs font-medium text-gray-600",children:["+",e.length-3]})})]})]})}},4168:function(e,s,t){"use strict";t.d(s,{o:function(){return n}});var a=t(4194),r=t(1700),l=t(1774);function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dashboard",{user:s,activeTeam:t}=(0,r.aC)(),[n,i]=(0,a.useState)([]),[c,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!s||!t)return;let a="team-".concat(t.id),r=l.OQ.channel(a,{config:{presence:{key:s.id}}}),n=()=>{var t,a;let l={user_id:s.id,email:s.email||"",full_name:(null===(t=s.user_metadata)||void 0===t?void 0:t.full_name)||s.email||"",avatar_url:null===(a=s.user_metadata)||void 0===a?void 0:a.avatar_url,page:e,last_seen:new Date().toISOString()};d(l),r.track(l)};r.on("presence",{event:"sync"},()=>{let e=r.presenceState(),t=[];Object.keys(e).forEach(s=>{let a=e[s];if(a&&a.length>0){let e=a.reduce((e,s)=>{let t=s.last_seen||new Date().toISOString(),a=e.last_seen||new Date().toISOString();return new Date(t)>new Date(a)?s:e});t.push(e)}}),i(t.filter(e=>e.user_id!==(null==s?void 0:s.id)).sort((e,s)=>new Date(s.last_seen||new Date).getTime()-new Date(e.last_seen||new Date).getTime()))}).on("presence",{event:"join"},e=>{let{key:s,newPresences:t}=e}).on("presence",{event:"leave"},e=>{let{key:s,leftPresences:t}=e}).subscribe(async e=>{"SUBSCRIBED"===e&&n()});let c=setInterval(()=>{"joined"===r.state&&n()},3e4),o=()=>{"visible"===document.visibilityState&&n()};return document.addEventListener("visibilitychange",o),()=>{clearInterval(c),document.removeEventListener("visibilitychange",o),l.OQ.removeChannel(r)}},[s,t,e]),{onlineUsers:n,myPresence:c}}},2528:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return w}});var a=t(1549),r=t(4194),l=t(55),n=t.n(l),i=t(5560),c=t(1700),d=t(4694),o=t(4168),m=t(755),x=t(2619),h=t(1774),u=t(2802),f=t(4032),g=t(4572),j=t(675),v=t(2746),p=t(119),N=t(96),b=t(777);function w(){let{activeTeam:e,user:s,userRole:t}=(0,c.aC)(),{rocks:l,loading:w,error:y}=(0,d.F)(),{onlineUsers:_}=(0,o.o)("rocks"),[k,S]=(0,r.useState)(""),[Z,D]=(0,r.useState)(""),[C,E]=(0,r.useState)("all"),[O,P]=(0,r.useState)([]);(0,r.useEffect)(()=>{l.length>0&&P([...l])},[l]),(0,r.useEffect)(()=>{if(!k){let e=new Date,s=e.getFullYear(),t=Math.ceil((e.getMonth()+1)/3);S("Q".concat(t," ").concat(s))}},[k]);let A=async e=>{if(!e.destination)return;let{source:s,destination:t}=e;if(s.index===t.index)return;let a=Array.from(O),[r]=a.splice(s.index,1);a.splice(t.index,0,r);let n=a.map((e,s)=>({...e,priority:s+1}));P(n);try{for(let e of n)await h.OQ.from("rocks").update({priority:e.priority}).eq("id",e.id)}catch(e){P([...l])}},I=e=>{switch(e){case"on_track":return"bg-green-100 text-green-800";case"off_track":return"bg-red-100 text-red-800";case"complete":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},L=(e,s)=>"complete"===s?"bg-blue-500":e>=75?"bg-green-500":e>=50?"bg-yellow-500":"bg-red-500",Q=O.filter(e=>{var s;let t=!k||e.quarter===k,a=!Z||e.title.toLowerCase().includes(Z.toLowerCase())||(null===(s=e.description)||void 0===s?void 0:s.toLowerCase().includes(Z.toLowerCase())),r="all"===C||e.status===C;return t&&a&&r}),T=Array.from(new Set(l.map(e=>e.quarter))).sort();return(0,a.jsx)(c.a1,{children:(0,a.jsx)(c.P6,{children:(0,a.jsxs)("div",{children:[(0,a.jsxs)(n(),{children:[(0,a.jsx)("title",{children:"Rocks - EOS L10 Platform"}),(0,a.jsx)("meta",{name:"description",content:"Quarterly rocks tracking and management"})]}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-6 w-6 mr-2 text-eos-600"}),"Rocks"]}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Track and prioritize quarterly goals"})]}),(0,a.jsxs)("div",{className:"mt-4 sm:mt-0 flex items-center space-x-3",children:[(0,a.jsx)(x.ZP,{page:"rocks"}),("leader"===t||"member"===t)&&(0,a.jsxs)(i.Z,{href:"/rocks/new",className:"btn-primary flex items-center",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"New Rock"]})]})]}),y&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("p",{className:"text-red-800 text-sm",children:["Error loading rocks: ",y]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsx)("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quarter"}),(0,a.jsxs)("select",{value:k,onChange:e=>S(e.target.value),className:"input",children:[(0,a.jsx)("option",{value:"",children:"All Quarters"}),T.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsxs)("select",{value:C,onChange:e=>E(e.target.value),className:"input",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"not_started",children:"Not Started"}),(0,a.jsx)("option",{value:"on_track",children:"On Track"}),(0,a.jsx)("option",{value:"off_track",children:"Off Track"}),(0,a.jsx)("option",{value:"complete",children:"Complete"})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search rocks...",value:Z,onChange:e=>D(e.target.value),className:"input pl-10"})]})]})]})})}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"card-title",children:[k||"All Quarters"," (",Q.length," rocks)"]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Drag to reorder priority"})]})}),(0,a.jsx)("div",{className:"card-content",children:w?(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"border rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,a.jsx)("div",{className:"skeleton w-8 h-8 rounded"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"skeleton h-5 w-2/3 mb-2"}),(0,a.jsx)("div",{className:"skeleton h-4 w-full mb-3"}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)("div",{className:"skeleton h-4 w-24"}),(0,a.jsx)("div",{className:"skeleton h-4 w-32"})]})]})]})},s))}):0===Q.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(u.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No rocks found"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:0===l.length?"Create your first quarterly rock to get started":"Try adjusting your filters"}),("leader"===t||"member"===t)&&0===l.length&&(0,a.jsxs)(i.Z,{href:"/rocks/new",className:"btn-primary",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Create First Rock"]})]}):(0,a.jsx)(b.Z5,{onDragEnd:A,children:(0,a.jsx)(b.bK,{droppableId:"rocks-list",children:(e,s)=>(0,a.jsxs)("div",{...e.droppableProps,ref:e.innerRef,className:"space-y-3 ".concat(s.isDraggingOver?"bg-blue-50 rounded-lg p-2":""),children:[Q.map((e,s)=>(0,a.jsx)(b._l,{draggableId:e.id,index:s,isDragDisabled:"viewer"===t,children:(s,r)=>(0,a.jsx)("div",{ref:s.innerRef,...s.draggableProps,className:"border rounded-lg p-4 bg-white hover:shadow-md transition-shadow ".concat(r.isDragging?"shadow-lg":""),children:(0,a.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,a.jsx)("div",{...s.dragHandleProps,className:"flex-shrink-0 p-1 rounded hover:bg-gray-100 cursor-grab active:cursor-grabbing",children:(0,a.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,a.jsx)("div",{className:"grid grid-cols-2 gap-0.5",children:[...Array(6)].map((e,s)=>(0,a.jsx)("div",{className:"w-1 h-1 bg-gray-400 rounded-full"},s))})})}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-eos-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-bold text-eos-700",children:e.priority})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(i.Z,{href:"/rocks/".concat(e.id),className:"text-lg font-semibold text-gray-900 hover:text-eos-600",children:e.title}),e.description&&(0,a.jsx)("p",{className:"text-gray-600 mt-1 text-sm line-clamp-2",children:e.description})]}),("leader"===t||"member"===t)&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,a.jsx)(i.Z,{href:"/rocks/".concat(e.id,"/edit"),className:"p-1 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(j.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{className:"p-1 text-gray-400 hover:text-red-600",children:(0,a.jsx)(v.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Progress"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.completion_percentage,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(L(e.completion_percentage,e.status)),style:{width:"".concat(e.completion_percentage,"%")}})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"Owner: ",e.owner_id]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-1"}),"Due: ",new Date(e.due_date).toLocaleDateString()]})]}),(0,a.jsx)("div",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(I(e.status)),children:e.status.replace("_"," ").toUpperCase()})]})]})]})})},e.id)),e.placeholder]})})})})]})]})})]})})})}}},function(e){e.O(0,[120,610,755,810,888,774,179],function(){return e(e.s=6876)}),_N_E=e.O()}]);