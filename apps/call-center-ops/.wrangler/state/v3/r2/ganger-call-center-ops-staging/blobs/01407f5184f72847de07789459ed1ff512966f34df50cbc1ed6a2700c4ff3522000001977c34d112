(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[170],{9481:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/agent",function(){return a(2952)}])},2952:function(e,t,a){"use strict";a.r(t);var r=a(1549),s=a(4194),n=a(7311),l=a(8848);let c=e=>new Date(e).toLocaleDateString(),i=e=>new Date(e).toLocaleTimeString();t.default=(0,n.FF)(function(){var e;let{user:t}=(0,n.aC)(),[a,o]=(0,s.useState)({performanceMetrics:{},goalProgress:[],recentCalls:[],coachingFeedback:[],isLoading:!0});(0,s.useEffect)(()=>{d();let e=setInterval(d,3e4);return()=>clearInterval(e)},[]);let d=async()=>{try{var e,a;let[r,s]=await Promise.all([fetch("/api/performance/agent-metrics?role=agent&agent_id=".concat(null==t?void 0:t.email)),fetch("/api/call-records/simple?limit=10")]),[n,l]=await Promise.all([r.json(),s.json()]);o({performanceMetrics:(null===(e=n.data)||void 0===e?void 0:e.current)||{},recentCalls:l.data||[],goalProgress:(null===(a=n.data)||void 0===a?void 0:a.weekly_trend)||[],coachingFeedback:[],isLoading:!1})}catch(e){o(e=>({...e,isLoading:!1}))}};return a.isLoading?(0,r.jsx)(l.LN,{children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-96",children:(0,r.jsx)(l.TK,{size:"lg"})})}):(0,r.jsxs)(l.LN,{children:[(0,r.jsx)(l.mr,{title:"Agent Dashboard",subtitle:"Welcome back, ".concat((null==t?void 0:null===(e=t.user_metadata)||void 0===e?void 0:e.full_name)||(null==t?void 0:t.email)||"Agent"),actions:(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)(l.zx,{variant:"primary",onClick:()=>window.location.href="/calls/journal",children:"\uD83D\uDCDD Log Call"}),(0,r.jsx)(l.zx,{variant:"outline",onClick:()=>window.location.href="/calls/history",children:"\uD83D\uDCDE Call History"})]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,r.jsx)(l.Rm,{title:"Calls Today",value:a.performanceMetrics.calls_today||0,trend:a.performanceMetrics.calls_trend&&"neutral"!==a.performanceMetrics.calls_trend?{value:a.performanceMetrics.calls_change||0,direction:a.performanceMetrics.calls_trend}:void 0,icon:"phone"}),(0,r.jsx)(l.Rm,{title:"Avg Call Time",value:"".concat(Math.round((a.performanceMetrics.avg_call_time||0)/60),"m"),trend:a.performanceMetrics.time_trend&&"neutral"!==a.performanceMetrics.time_trend?{value:a.performanceMetrics.time_change||0,direction:a.performanceMetrics.time_trend}:void 0,icon:"clock"}),(0,r.jsx)(l.Rm,{title:"Quality Score",value:"".concat(a.performanceMetrics.quality_score||0,"%"),trend:a.performanceMetrics.quality_trend&&"neutral"!==a.performanceMetrics.quality_trend?{value:a.performanceMetrics.quality_change||0,direction:a.performanceMetrics.quality_trend}:void 0,icon:"star"}),(0,r.jsx)(l.Rm,{title:"Appointments",value:a.performanceMetrics.appointments_today||0,trend:a.performanceMetrics.appointments_trend&&"neutral"!==a.performanceMetrics.appointments_trend?{value:a.performanceMetrics.appointments_change||0,direction:a.performanceMetrics.appointments_trend}:void 0,icon:"calendar"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(l.Zb,{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:"Goal Progress"}),(0,r.jsx)("div",{className:"space-y-4",children:a.goalProgress.map((e,t)=>(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-neutral-700",children:e.title}),(0,r.jsxs)("span",{className:"text-sm text-neutral-600",children:[e.current,"/",e.target]})]}),(0,r.jsx)("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"h-2 rounded-full ".concat(e.progress>=100?"bg-green-600":e.progress>=80?"bg-blue-600":e.progress>=60?"bg-amber-600":"bg-red-600"),style:{width:"".concat(Math.min(e.progress,100),"%")}})}),(0,r.jsxs)("div",{className:"text-xs text-neutral-500",children:[e.progress.toFixed(1),"% complete"]})]},t))})]}),(0,r.jsxs)(l.Zb,{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:"Daily Performance"}),(0,r.jsx)("div",{className:"h-64 flex items-center justify-center bg-gray-50 rounded"})]})]}),(0,r.jsxs)(l.Zb,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-neutral-900",children:"Recent Calls"}),(0,r.jsx)(l.zx,{variant:"outline",size:"sm",onClick:()=>window.location.href="/calls/history",children:"View All"})]}),(0,r.jsx)(l.wQ,{data:a.recentCalls,columns:[{key:"caller_name",header:"Caller",sortable:!0,render:e=>e.caller_name||"Unknown"},{key:"call_start_time",header:"Time",sortable:!0,render:e=>i(e.call_start_time)},{key:"call_outcome",header:"Outcome",render:e=>{var t;return(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs ".concat("appointment_scheduled"===e.call_outcome?"bg-green-100 text-green-800":"information_provided"===e.call_outcome?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:(null===(t=e.call_outcome)||void 0===t?void 0:t.replace("_"," "))||"No outcome"})}},{key:"talk_duration_seconds",header:"Duration",render:e=>{let t=Math.floor((e.talk_duration_seconds||0)/60),a=(e.talk_duration_seconds||0)%60;return"".concat(t,":").concat(a.toString().padStart(2,"0"))}}]})]}),(0,r.jsxs)(l.Zb,{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:"Recent Coaching Feedback"}),0===a.coachingFeedback.length?(0,r.jsxs)("div",{className:"text-center py-8 text-neutral-500",children:[(0,r.jsx)("p",{children:"No recent coaching feedback available."}),(0,r.jsx)("p",{className:"text-sm mt-2",children:"Keep up the great work!"})]}):(0,r.jsx)("div",{className:"space-y-4",children:a.coachingFeedback.map((e,t)=>(0,r.jsx)("div",{className:"border-l-4 border-blue-500 pl-4 py-2",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-neutral-900",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-neutral-600 mt-1",children:e.content})]}),(0,r.jsx)("span",{className:"text-xs text-neutral-500",children:c(e.created_at)})]})},t))})]})]})]})},{requiredRoles:["staff","manager","superadmin"]})}},function(e){e.O(0,[946,848,888,774,179],function(){return e(e.s=9481)}),_N_E=e.O()}]);