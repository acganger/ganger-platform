"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{2920:function(e,t,i){i.d(t,{TemplateLoader:function(){return l}});let a={auth:{getSession:()=>Promise.resolve({data:{session:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},from:()=>({select:()=>({eq:()=>({single:()=>Promise.resolve({data:null,error:{message:"Not available during build"}}),order:()=>Promise.resolve({data:[],error:null})}),order:()=>Promise.resolve({data:[],error:null})}),insert:()=>Promise.resolve({data:null,error:{message:"Not available during build"}}),update:()=>({eq:()=>Promise.resolve({data:null,error:{message:"Not available during build"}})}),delete:()=>({eq:()=>Promise.resolve({data:null,error:{message:"Not available during build"}})})})},n=null;async function o(){if(n)return n;let e="https://pfqtzmxxxhhsxmlddrta.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBmcXR6bXh4eGhoc3htbGRkcnRhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzI5OTQ5NjQsImV4cCI6MjA0ODU3MDk2NH0.eLPNjjpDLG0GKVHCJ6eTSWWOFCJuIOkOsILI9HxZNLM";if(!e||!t)return console.warn("Supabase environment variables not found or running in build mode, using mock client"),a;let{createClient:o}=await Promise.resolve().then(i.bind(i,1635));return n=o(e,t,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})}let r=new Proxy(a,{get:(e,t)=>new Proxy(()=>{},{apply:async(e,i,a)=>{var n;let r=await o();return null===(n=r[t])||void 0===n?void 0:n.apply(r,a)},get:async(e,i)=>{var a;return null===(a=(await o())[t])||void 0===a?void 0:a[i]}})});class l{static async loadLegacyTemplates(){if(this.legacyTemplates.length>0)return this.legacyTemplates;try{let e=[];for(let t of["acne-handout-kf","acne-treatment-regimen","eczema-treatment-regimen","isotretinoin-female-handout","patch-testing","rosacea-handout","sun-protection-recommendations","vinegar-soak-nails","static-wound-care","static-psoriasis"])try{let i=this.createMockTemplate(t);e.push(i)}catch(e){}return this.legacyTemplates=e,e}catch(e){return[]}}static async loadTemplate(e){if(this.templateCache.has(e))return this.templateCache.get(e);try{let{data:t,error:i}=await r.from("handout_templates").select("*").eq("id",e).eq("is_active",!0).single();if(t&&!i)return this.templateCache.set(e,t),t;let a=(await this.loadLegacyTemplates()).find(t=>t.id===e);if(a){let t=this.convertLegacyTemplate(a);return this.templateCache.set(e,t),t}return null}catch(e){return null}}static async loadAllTemplates(){try{let{data:e,error:t}=await r.from("handout_templates").select("*").eq("is_active",!0).order("template_name"),i=e||[];for(let e of(await this.loadLegacyTemplates()))if(!i.some(t=>t.legacy_template_id===e.id)){let t=this.convertLegacyTemplate(e);i.push(t)}return i.forEach(e=>{this.templateCache.set(e.id,e)}),i}catch(e){return[]}}static convertLegacyTemplate(e){let t=new Date().toISOString();return{id:"legacy_".concat(e.id),template_name:e.name,category:this.mapLegacyCategory(e.category),subcategory:void 0,description:e.description||"Legacy template: ".concat(e.name),template_type:this.inferTemplateType(e),template_content:this.convertLegacyContent(e),fill_in_fields:e.fill_in_fields||e.fields||[],conditional_logic:e.conditionalLogic||[],validation_rules:[],complexity_level:this.inferComplexity(e),estimated_completion_time:this.estimateCompletionTime(e),provider_specific:!1,location_specific:void 0,specialty_tags:[e.category],digital_delivery_enabled:!1!==e.digital_delivery_enabled,requires_physician_review:!1,medical_specialty:"dermatology",language_code:"en-US",is_active:!0,version_number:1,parent_template_id:void 0,approval_status:"approved",approved_by:void 0,approved_at:void 0,source_file:"".concat(e.id,".json"),legacy_template_id:e.id,migration_notes:"Converted from legacy JSON template",created_by:"system",last_modified_by:"system",created_at:t,updated_at:t}}static createMockTemplate(e){return({"acne-handout-kf":{id:"acne-handout-kf",name:"Acne Treatment Plan (Complex)",category:"treatment",description:"Comprehensive acne treatment with 14 conditional medication options",digital_delivery_enabled:!0,content:[{type:"section",title:"Treatment Overview",content:"This personalized treatment plan has been created for {{patient_first_name}} {{patient_last_name}}."},{type:"conditional_checklist",items:[{id:"benzoyl_peroxide_wash",content:"Wash affected areas with {{benzoyl_peroxide_percent}}% benzoyl peroxide cleanser {{wash_frequency}} daily",fields:[{id:"benzoyl_peroxide_percent",type:"select",label:"Benzoyl Peroxide %",required:!0,options:["2.5","5","10"]},{id:"wash_frequency",type:"select",label:"Frequency",required:!0,options:["once","twice"]}]}]}],fill_in_fields:[{id:"benzoyl_peroxide_percent",type:"select",label:"Benzoyl Peroxide Percentage",required:!0},{id:"wash_frequency",type:"select",label:"Wash Frequency",required:!0}]},"sun-protection-recommendations":{id:"sun-protection-recommendations",name:"Sun Protection Guidelines",category:"education",description:"UV protection and skin cancer prevention guidelines",digital_delivery_enabled:!0,content:[{type:"section",title:"UV Protection Basics",content:["Use SPF 30 or higher sunscreen daily","Reapply every 2 hours when outdoors","Wear protective clothing and wide-brimmed hats","Seek shade during peak hours (10 AM - 4 PM)"]}],fill_in_fields:[]},"patch-testing":{id:"patch-testing",name:"Patch Testing Instructions",category:"pre_procedure",description:"Pre-procedure preparation for allergy testing",digital_delivery_enabled:!0,content:[{type:"section",title:"Before Your Appointment",content:"Please follow these instructions before your patch testing appointment."}],fill_in_fields:[]},"vinegar-soak-nails":{id:"vinegar-soak-nails",name:"Vinegar Soaks for Nails",category:"treatment",description:"Simple nail treatment instructions using vinegar soaks",digital_delivery_enabled:!0,content:[{type:"section",title:"Vinegar Soak Recipe",content:["1 part white vinegar","3 parts water","Submerge nails for 10-15 minutes"]}],fill_in_fields:[]}})[e]||{id:e,name:e.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()),category:"education",description:"Template for ".concat(e),digital_delivery_enabled:!0,content:[],fill_in_fields:[]}}static mapLegacyCategory(e){return({education:"education",treatment:"treatment",medication:"medication",pre_procedure:"pre_procedure",post_procedure:"post_procedure"})[e]||"education"}static inferTemplateType(e){var t,i,a,n;let o=((null===(t=e.fill_in_fields)||void 0===t?void 0:t.length)||0)>0||((null===(i=e.fields)||void 0===i?void 0:i.length)||0)>0;return((null===(a=e.conditionalLogic)||void 0===a?void 0:a.length)||0)>0||(null===(n=e.content)||void 0===n?void 0:n.some(e=>"conditional_checklist"===e.type))?"conditional":o?"dynamic":"static"}static inferComplexity(e){var t,i,a;let n=((null===(t=e.fill_in_fields)||void 0===t?void 0:t.length)||0)+((null===(i=e.fields)||void 0===i?void 0:i.length)||0);return((null===(a=e.conditionalLogic)||void 0===a?void 0:a.length)||0)>0||n>8?3:n>3?2:1}static estimateCompletionTime(e){let t=this.inferComplexity(e);return 3===t?5:2===t?3:1}static convertLegacyContent(e){var t;return{sections:(null===(t=e.content)||void 0===t?void 0:t.map((e,t)=>({id:"section_".concat(t),type:e.type||"static_text",title:e.title,content:Array.isArray(e.content)?e.content.join("\n"):e.content,items:e.items,fields:e.fields})))||[]}}static clearCache(){this.templateCache.clear(),this.legacyTemplates=[]}}l.templateCache=new Map,l.legacyTemplates=[]}}]);