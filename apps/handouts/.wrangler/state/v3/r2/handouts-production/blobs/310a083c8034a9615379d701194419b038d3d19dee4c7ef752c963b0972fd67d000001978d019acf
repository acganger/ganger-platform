(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[276],{37:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/history",function(){return a(3443)}])},3443:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var s=a(1549),n=a(4194),l=a(8097),d=a(8868),r=a(8816);function i(){let{user:e,profile:t}=(0,l.aC)(),[a,i]=(0,n.useState)([]),[o,c]=(0,n.useState)(!0),[u,x]=(0,n.useState)(""),[h,m]=(0,n.useState)("7d");(0,n.useEffect)(()=>{(async()=>{try{i([{id:"1",patientName:"John Doe",patientMRN:"MRN001",templates:["Acne Treatment Plan","Sun Protection Guidelines"],generatedAt:"2024-01-15T10:30:00Z",generatedBy:"Jane Smith",deliveryMethods:["print","email"],status:"completed",emailStatus:"delivered",downloadCount:3,lastDownloaded:"2024-01-15T14:22:00Z"},{id:"2",patientName:"Mary Johnson",patientMRN:"MRN002",templates:["Patch Testing Instructions"],generatedAt:"2024-01-15T09:15:00Z",generatedBy:"Mike Wilson",deliveryMethods:["print","sms"],status:"completed",smsStatus:"delivered",downloadCount:1,lastDownloaded:"2024-01-15T12:45:00Z"},{id:"3",patientName:"Robert Brown",patientMRN:"MRN003",templates:["Isotretinoin for Female Patients"],generatedAt:"2024-01-14T16:45:00Z",generatedBy:"Sarah Davis",deliveryMethods:["print","email"],status:"completed",emailStatus:"failed",downloadCount:0}]),r.co.track("history_page_viewed","navigation",{user_role:null==t?void 0:t.role,date_range:h})}catch(e){}finally{c(!1)}})()},[t,h]);let p=a.filter(e=>{let t=u.toLowerCase();return e.patientName.toLowerCase().includes(t)||e.patientMRN.toLowerCase().includes(t)||e.templates.some(e=>e.toLowerCase().includes(t))}),N=[{key:"patientName",header:"Patient",sortable:!0},{key:"patientMRN",header:"MRN",sortable:!0},{key:"templates",header:"Templates",render:e=>(0,s.jsx)("div",{className:"space-y-1",children:e.templates.map((e,t)=>(0,s.jsx)("div",{className:"text-sm text-gray-600",children:e},t))})},{key:"generatedAt",header:"Generated",sortable:!0,render:e=>new Date(e.generatedAt).toLocaleDateString()},{key:"generatedBy",header:"Generated By",sortable:!0},{key:"deliveryMethods",header:"Delivery",render:e=>(0,s.jsx)("div",{className:"flex gap-1",children:e.deliveryMethods.map(e=>(0,s.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800",children:e},e))})},{key:"status",header:"Status",render:e=>(0,s.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("completed"===e.status?"bg-green-100 text-green-800":"generating"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status})},{key:"downloadCount",header:"Downloads",sortable:!0,render:e=>(0,s.jsx)("span",{className:"text-sm font-medium",children:e.downloadCount})}],g=a.length,y=a.reduce((e,t)=>e+t.downloadCount,0),v=a.filter(e=>e.deliveryMethods.includes("email")||e.deliveryMethods.includes("sms")).length;return o?(0,s.jsx)(d.LN,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)(d.TK,{size:"lg"})})}):(0,s.jsxs)(d.LN,{children:[(0,s.jsx)(d.mr,{title:"Handout History",subtitle:"View generated handouts and delivery status",actions:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.zx,{variant:"outline",size:"sm",children:"Export Report"}),(0,s.jsx)(d.zx,{variant:"outline",size:"sm",children:"Download Data"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,s.jsx)(d.Zb,{className:"p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-handouts-primary",children:g}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Total Generated"})]})}),(0,s.jsx)(d.Zb,{className:"p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[g>0?Math.round(v/g*100):0,"%"]}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Digital Delivery Rate"})]})}),(0,s.jsx)(d.Zb,{className:"p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:y}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Total Downloads"})]})}),(0,s.jsx)(d.Zb,{className:"p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:a.filter(e=>"completed"===e.status).length}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Successful"})]})})]}),(0,s.jsxs)(d.Zb,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Generated Handouts"}),(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,s.jsxs)("select",{value:h,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-handouts-primary focus:border-transparent",children:[(0,s.jsx)("option",{value:"1d",children:"Last 24 hours"}),(0,s.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,s.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,s.jsx)("option",{value:"90d",children:"Last 90 days"})]}),(0,s.jsx)(d.II,{placeholder:"Search patients, MRN, templates...",value:u,onChange:e=>x(e.target.value),className:"w-80"})]})]}),(0,s.jsx)(d.wQ,{data:p,columns:N,onRowClick:e=>{r.co.track("handout_history_clicked","interaction",{handout_id:e.id,patient_mrn:e.patientMRN})}}),0===p.length&&(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:u?"No handouts found matching your search criteria.":"No handouts generated in the selected time period."})]})]})}function o(){return(0,s.jsx)(l.a1,{level:"staff",appName:"handouts",children:(0,s.jsx)(i,{})})}}},function(e){e.O(0,[411,435,738,868,957,888,774,179],function(){return e(e.s=37)}),_N_E=e.O()}]);